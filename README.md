# SmartManufacturingScheduler
VBA
✅ 如何使用（Usage）
1. 准备 Excel 模板
本项目需要三个工作表（名称必须一致）：
📄 1）Orders
用于放置工单数据，示例结构：
OrderID	Qty	LineType	DemandDate
A001	120	RW	2025/11/18
A002	80	BTT	2025/11/25
...	...	...	...
📄 2）Config
用于存放基础参数及产能设置：
Key	Value
RW_日常产能	400
97/98/06	200
BTT常产能	50
预留产能	0
StartDate	2025/11/21
EndDate	2025/12/31
组装天数	3
包装天数	1
注意：第 7 行 Key 必须是：焊接产能
因为系统内部会用这个做合并产能控件。
📄 3）Result（自动生成）
用于输出排产结果（系统会自动覆盖旧文件）。
2. 运行排产（Run Scheduler）
✔ 方法 A：直接运行宏
Excel 打开后按 Alt + F11
找到模块 Module1
双击打开，找到主程序：
Sub RunFullSchedule()
按 F5 运行
系统会自动：
读取工单
解析产能
平滑排产
跨周期调整工单位置
顺延到下个月 1 号
生成甘特图
输出排产明细到 Result 表
✔ 方法 B：用按钮执行（推荐）
在 Excel 插入一个按钮 → 绑定到：
RunFullSchedule
以后就可以一键排产了
3. 结果包含以下字段（自动生成）
Result 工作表会生成：
OrderID	排产日期	数量	延误天数	工序	状态
A001	2025/11/21	120	0	焊接	正常
A001	2025/11/24	120	0	组装	正常
A001	2025/11/25	120	0	包装	正常
A002	2025/12/01	80	4	组装	红色延误
...	...	...	...	...	...
4. 延误状态规则
🟡 黄标延误
如果需求日不在周期内 → 自动调整到周期起始日
→ 标黄
🔴 红标延误
如果产能不足 → 顺延施工日期
→ 延误天数 = 实际开始日期 - DemandDate
→ 超过 0 天标红
📌 延误分级（三天一档）
系统自动将延误分类：
0：正常

1~3 天：轻微延误

4~6 天：中度延误

7 天：重度延误
分类会用于甘特图颜色。
5. 甘特图自动生成
系统会生成：
焊接阶段甘特图
组装阶段甘特图
包装阶段甘特图
状态颜色图例
订单甘特汇总图
